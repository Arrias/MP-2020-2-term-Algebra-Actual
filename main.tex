\documentclass[10pt,a4paper,oneside]{book}
\usepackage[a4paper,includeheadfoot,top=5mm,bottom=10mm,left=10mm,right=10mm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{cmap} % Поддержка поиска русских слов в PDF (pdflatex)
\usepackage{comment}
%\usepackage{pdfsync} % синхронизация

\usepackage{amsmath,amsthm,amssymb,amscd,array}
\usepackage{latexsym}
\usepackage{stmaryrd} % Для знака нормальной подгруппы
\usepackage{misccorr} % российская полиграфия
\usepackage{indentfirst}% Красная строка в первом абзаце
\usepackage{ccaption} % Заголовки таблиц и рисунков
\usepackage{fancyhdr} % колонтитулы
\usepackage{hyperref} % гиперссылки

\usepackage{rotating} % Поворот текста
\usepackage{graphicx} % Вставка изображений
\usepackage{xcolor}
\usepackage{pgf}
\usepackage{tikz}
\usepackage{tikz-cd}
\usetikzlibrary{arrows,backgrounds,patterns,matrix,shapes,fit,calc,shadows,plotmarks}
\graphicspath{ {./} } % относительно main.tex

\usepackage{arydshln} % штрихованные линии в массивах
\usepackage{mathtools} % выравнивание в матрицах
\usepackage{multirow} % слияние в столбце
\usepackage{multicol} % нумерация в нескольких колонках


\newtheorem{uprz}{\color{violet!100!black} Упражнение}
\newtheorem{predl}{\color{blue!50!black} Предложение}
\newtheorem{komment}{\color{green!50!blue} Комментарий}
\newtheorem{conj}{Гипотеза}
\newtheorem{notation}{\color{yellow!30!red} Обозначение}


\theoremstyle{definition}
\newtheorem{kit}{Кит}
\newtheorem*{rem}{\color{green!50!blue}Замечание}
\newtheorem{zad}{\color{violet!100!black}Задача}
\newtheorem*{defn}{\color{yellow!30!red} Определение}
\newtheorem*{fact}{Факт}
\newtheorem{thm}{\color{red!40!black}Теорема}
\newtheorem*{thmm}{\color{red!40!black} Теорема}
\newtheorem{lem}{\color{green!50!black}Лемма}
\newtheorem{cor}{\color{green!45!black}Следствие}
\newtheorem{utvr}{\color{blue!50!black}Утверждение}


\newcommand\tikznode[3][]%
   {\tikz[remember picture,baseline=(#2.base)]
      \node[minimum size=0pt,outer sep=0pt,#1](#2){#3};%
   }
\tikzset{>=stealth}


\hypersetup{
    colorlinks,
    linkcolor={blue!50!black},
    citecolor={blue!50!black},
    urlcolor={red!80!black}
}
% цвета для ссылок


\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{#1}}
\makeatother


\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\renewcommand{\proofname}{Доказательство}
\renewcommand{\mod}{\,\operatorname{mod}\,}
\renewcommand{\Re}{\operatorname{Re}}
\newcommand{\mf}[1]{\mathfrak{#1}}
\newcommand{\mcal}[1]{\mathcal{#1}}
\newcommand{\mb}[1]{\mathbb{#1}}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\tbf}[1]{\textbf{#1}}
\newcommand{\ovl}{\overline}
\newcommand{\Spec}{\operatorname{Spec}}
\newcommand{\K}{\operatorname{K_0}}
\newcommand{\witt}{\operatorname{W}}
\newcommand{\gw}{\operatorname{GW}}
\newcommand{\coh}{\operatorname{H}}
\newcommand{\dist}{\operatorname{dist}}
\newcommand{\cl}{\operatorname{Cl}}
\newcommand{\Vol}{\operatorname{Vol}}
\newcommand\tgg{\mathop{\rm tg}\nolimits}
\newcommand\ccup{\mathop{\cup}}
\newcommand{\id}{\operatorname{id}}
\newcommand{\lcm}{\operatorname{lcm}}
\newcommand{\chr}{\operatorname{char}}
\newcommand{\rk}{\operatorname{rk}}
\DeclareMathOperator{\Coker}{Coker}
\DeclareMathOperator{\Ker}{Ker}
\newcommand{\im}{\operatorname{Im}}
\renewcommand{\Im}{\operatorname{Im}}
\newcommand{\Tr}{\operatorname{Tr}}
\newcommand{\re}{\operatorname{Re}}
\newcommand{\tr}{\operatorname{Tr}}
\newcommand{\ord}{\operatorname{ord}}
\newcommand{\Stab}{\operatorname{Stab}}
\newcommand{\orb}{\operatorname{\mathcal O}}
\newcommand{\Fix}{\operatorname{Fix}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\End}{\operatorname{End}}
\newcommand{\Aut}{\operatorname{Aut}}
\newcommand{\Inn}{\operatorname{Inn}}
\newcommand{\Out}{\operatorname{Out}}
\newcommand{\GL}{\operatorname{GL}}
\newcommand{\SL}{\operatorname{SL}}
\newcommand{\SO}{\operatorname{SO}}
\renewcommand{\O}{\operatorname{O}}
\renewcommand{\U}{\operatorname{U}}
\newcommand{\Sym}{\operatorname{Sym}}
\newcommand{\Adj}{\operatorname{Adj}}
\newcommand{\Disc}{\operatorname{Disc}}
\newcommand{\cnt}{\operatorname{cont}}
\newcommand{\Frob}{\operatorname{Frob}}
\newcommand{\Iso}{\operatorname{Iso}}
\newcommand{\Isom}{\operatorname{Isom}}
\newcommand{\supp}{\operatorname{supp}}
\newcommand{\di}{\mathop{\,\scalebox{0.85}{\raisebox{-1.2pt}[0.5\height]{\vdots}}\,}}
\newcommand{\ndi}{\mathop{\not\scalebox{0.85}{\raisebox{-1.2pt}[0.5\height]{\vdots}}\,}}
\newcommand{\nequiv}{\not \equiv}
\newcommand{\Nod}{\operatorname{\text{НОД}}}
\newcommand{\Nok}{\operatorname{\text{НОК}}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\codim}{\operatorname{codim}}
\newcommand{\Aff}{\operatorname{Aff}}
\newcommand{\AGL}{\operatorname{AGL}}

\def\llq{\textquotedblleft} 
\def\rrq{\textquotedblright} 
\def\exm{\noindent {\bf Примеры:}}


\def\Cb{\ovl{C}}
\def\ffi{\varphi}
\def\pa{\partial}
\def\V{\bf V}
\def\La{\Lambda}
\def\eps{\varepsilon}
\def\del{\delta}
\def\Del{\Delta}
\def\A{\EuScript{A}}
\def\lan{\left\langle }
\def\ran{\right\rangle}
\def\bar{\begin{array}}
\def\ear{\end{array}}
\def\beq{\begin{equation}}
\def\eeq{\end{equation}}
\def\thrm{\begin{thm}}
\def\ethrm{\end{thm}}
\def\dfn{\begin{defn}}
\def\edfn{\end{defn}}
\def\lm{\begin{lem}}
\def\elm{\end{lem}}
\def\zd{\begin{zad}}
\def\ezd{\end{zad}}
\def\prdl{\begin{predl}}
\def\eprdl{\end{predl}}
\def\crl{\begin{cor}}
\def\ecrl{\end{cor}}
\def\rm{\begin{rem}}
\def\erm{\end{rem}}
\def\fct{\begin{fact}}
\def\efct{\end{fact}}
\def\enm{\begin{enumerate}}
\def\eenm{\end{enumerate}}
\def\pmat{\begin{pmatrix}}
\def\epmat{\end{pmatrix}}
\def\utv{\begin{utvr}}
\def\eutv{\end{utvr}}
\def\upr{\begin{uprz}}
\def\eupr{\end{uprz}}
\def\nrml{\trianglelefteqslant}

\frenchspacing
\righthyphenmin=2
%\usepackage{floatflt}
\captiondelim{. }








\title{Актуальный конспект. СП. Алгебра 2020}
\author{Чепуркин К.М.}
\date{}

\begin{document}

% \maketitle

\tableofcontents

\setcounter{chapter}{5}
\chapter{Группы}

\section{Немного примеров}

Мы уже обсуждали примеры групп раньше. Вспомним некоторые из них  и посмотрим, что к ним добавилось.

\exm \\
1) Если $R$-кольцо, то группу $R$ относительно сложения будем обозначать просто как $R$\\
2) Если $R$-кольцо, то $R^*$ -- это группа обратимых элементов.\\
3) Группа биекций $S_X$ на множестве $X$. В частности, $S_n$ -- группа биекций на $\{1,\dots,n\}$. Каждая такая биекция $\sigma \in  S_n$ однозначно задаётся последовательностью $\sigma(1),\dots,\sigma(n)$. В этой последовательности перечислены все элементы множества $\{1,\dots,n\}$, но, возможно, в другом порядке. Мы будем обозначать такую перестановку $\sigma=[\sigma(1),\dots,\sigma(n)]$. Например, обозначение тождественной перестановки будет $[1,\dots,n]$. А вот перестановка $[2,1,3,4,\dots,n]$ меняет местами $1$ и $2$, но все остальные элементы оставляет на месте.\\ 
4) Рассмотрим группу $D_n$. Это подгруппа $\Isom_{\mb R^2}$ состоящая из самосовмещений правильного $n$-угольника на плоскости. Покажем, что в этой группе $2n$ элементов. Прежде всего предъявим их, а потом покажем, что других нет. Здесь стоит различать два случая: $n$ -- чётное, $n$ -- нечётное. Если $n$ -- нечётное, то есть повороты на углы $\ffi=\frac{2\pi k}{n}$, где $k\in \ovl{0,1}$ и $n$ симметрий относительно прямых проходящих через какую-то вершину и центр $n$-угольника. Если же $n$ -- чётное, то элементами $D_n$ так же являются повороты на  $\ffi=\frac{2\pi k}{n}$, но симметрии делятся на два типа -- $\frac{n}{2}$ симметрий относительно прямых, проходящих через пары противоположенных вершин и $\frac{n}{2}$ симметрий относительно прямых, проходящих через середины противоположенных сторон $n$-угольника.

Для того, чтобы показать, что в этой группе не более $2n$ элементов воспользуемся следующими фактами:

\fct Любая изометрия плоскости определяется своими значениями в трёх точках, не лежащих на одной прямой (определяется тем, куда переводит вершины невырожденного треугольника). 

Любое самосовмещение правильного $n$-угольника переводит его вершины в вершины и центр в центр.
\efct

Пусть $f\in  D_n$, $x_0$ -- некоторая вершина $n$-угольника, $x_1$ -- соседняя вершина с $x_0$. Заметим, что образом точки $x_0$ может служить любая вершина $n$-угольника $y_0$. Итого для образа $x_0$ есть $n$ вариантов. Пусть $x_0$ перешёл в $y_0$. Тогда для $x_1$ есть не более двух вариантов, а именно $x_1$ обязан перейти в соседа $y_0$, которых ровно 2. 

Заметим, что отображение $f$ задаётся образами точек $x_0$ и $x_1$. Действительно, ведь центр $n$-угольника переходит в центр и поэтому фактически мы знаем куда переходят 3 точки, не лежащие на одной прямой -- $x_0, x_1$ и центр. Но для значений $x_0,x_1$ не более $2n$ вариантов, как мы только что поняли. Значит, элементов из $D_n$ не более и, следовательно, ровно $2n$ штук.\\
5) Если $V$ -- векторное пространство над полем $K$, то $\GL(V)$ -- это группа всех обратимых линейных отображений из $V$ в $V$. В частности, если $V=K^n$, то элементы группы $\GL_n(V)$ соответствуют обратимым матрицам с операцией умножения. Группа таких матриц обозначается $\GL_n(K)$.\\

Группа $D_n$ является подгруппой группы $GL_2(\mb R)$. Действительно, любая изометрия переводит параллелограмм в параллелограмм, и, следовательно, сумму векторов в сумму векторов.\\
6) Определим группу аффинных преобразований $n$-мерного пространства как
$$\Aff_n(K)=\AGL_n(K)=\{ f\colon K^n\to K^n\,|\, f(x)=Ax+b, \text{ где } A\in\GL_n(K), \, b \in K^n\}.$$




\section{Подгруппа, порождённая множеством. Циклические группы}

Прежде всего сделаем техническое замечание:

\rm Пусть дан набор подгрупп $H_{\alpha}$, где элементы $\alpha$ пробегают множество индексов $I$. Тогда пересечение $$\bigcap_{\alpha \in I}H_{\alpha}$$
тоже подгруппа $G$.
\erm


\dfn
Пусть $G$ - группа, а $X$ некоторое подмножество $G$. Тогда подгруппой, порождённой $X$, называется наименьшая подгруппа $H\leq G$, содержащая $X$. Будем обозначать эту подгруппу за $\langle X\rangle$. Эта подгруппа всегда существует и совпадает с подгруппой, равной пересечению подгрупп содержащих $X$
$$\langle X\rangle=\bigcap\limits_{ X\subseteq L \leq G} L.$$
Если множество $X$ состоит из конечного числа элементов, $X=\lan x_1,\dots, x_n\ran$,  то мы будем писать просто $\langle x_1 ,\dots, x_n\rangle$, а не $\lan\{x_1,\dots,x_n\}\ran$.
\edfn


\utv
Подгруппа $\langle X\rangle$ допускает альтернативное определение $$\langle X\rangle=\{x_1^{\eps_1}\cdots x_n^{\eps_n} \,|\, \text{ где $x_i\in X $, $\eps_i\in \{\pm 1\}$ }\}.$$
Если взять $n=0$, то положим такое произведение равным $1$.
\eutv
\proof Понятно, что элементы вида $x_1^{\eps_1}\cdots x_n^{\eps_n}$ обязаны лежать в подгруппе, содержащей $X$, а значит и в $\lan X\ran$. Это даёт включение $ \{x_1^{\eps_1}\cdots x_n^{\eps_n} \,|\, \text{ где $x_i\in X $, $\eps_i\in \{\pm 1\}$ }\} \subseteq \langle X\rangle.$ Осталось показать включение в другую сторону. Для этого покажем, что множество $\{x_1^{\eps_1}\cdots x_n^{\eps_n} \,|\, \text{ где $x_i\in X $, $\eps_i\in \{\pm 1\}$ }\}$ --- подгруппа в $G$. Так как это множество содержит $X$, то, являясь подгруппой, оно необходимо должно содержать $\lan X\ran$, как наименьшую подгруппу с этим свойством.

Для проверки того, что это подгруппа, надо всего лишь заметить, что произведение выражений $x_1^{\eps_1}\dots x_n^{\eps_n}$  и $y_1^{\gamma_1}\dots y_m^{\gamma_m}$ есть $x_1^{\eps_1}\dots x_n^{\eps_n}y_1^{\gamma_1}\dots y_m^{\gamma_m}$, то есть снова выражение такого вида. 
Так же обратный $(x_1^{\eps_1}\dots x_n^{\eps_n})^{-1}=x_n^{-\eps_n}\dots x_1^{-\eps_1}$ есть снова выражение такого вида. Единица, как мы отметили, соответствует случаю $n=0$.
\endproof

\dfn
Пусть $G$ группа, а $g\in G$ --- некоторый элемент. Подгруппа вида $$\langle g \rangle=\{g^n\,|\, n\in \mb Z\}$$
называется циклической подгруппой группы $G$, порождённой $g$.
\edfn

\dfn Будем говорить, что группа $G$ порождена множеством $X$, если $\lan X\ran =G$. Если множество $X$ конечно и состоит из элементов $x_1,\dots,x_n$, то будем писать $G=\lan x_1,\dots,x_n \ran$ и называть $x_1,\dots,x_n$ образующими $G$. Если такое конечное множество есть, то  будем говорить, что $G$ конечно порождена. 
\edfn

\dfn Группа $G$ называется циклической, если она порождена одним элементом. То есть, если существует такой $g\in G$, что $G=\lan g \ran$.
\edfn

\exm
\enm
\item Группа $\mb Z$ -- циклическая. В качестве её образующих можно взять элементы $1$ или $-1$.
\item Группа $\mb Z/n$ -- тоже циклическая -- в качестве её образующих можно взять любой элемент $l$ взаимно простой с $n$.
\item Рассмотрим группу $D_n$. Может ли она быть порождена одним элементом? Ответ: нет. Самое простое объяснение заключается в том, что группа $D_n$ не абелева. Ведь поворот на угол $\ffi$ относительно точки $x_0$ и симметрия относительно прямой, проходящей через эту точку не коммутируют (если $\ffi \neq 0, \pi $). С другой стороны, элементы циклической группы $\lan g\ran$ -- степени одного элемента $g$ -- коммутируют между собой, ведь $g^ig^j=g^{i+j}=g^jg^i$.

Чем же можно породить группу $D_n$? Оказывается, двух элементов уже достаточно.

\utv Пусть $f_{\ffi}$ -- поворот на угол   $\ffi=\frac{2\pi}{n}$ и $f_l \in D_n$ -- симметрия относительно какой-нибудь прямой.
Тогда $\lan f_{\ffi},f_l\ran =D_n$.
\eutv
\proof
Совершенно понятно, как получить поворот на угол $\frac{2\pi k}n$ -- это есть $f_{\ffi}^k$. Но как получить произвольную симметрию относительно прямой? Это не такой простой вопрос. Мы всего лишь покажем, что такое представление существует. А именно: рассмотрим набор $f_l^{\eps} f_{\ffi}^k$, где $\eps\in \ovl{0,1}$, а $k\in \ovl{0,n-1}$.  Мы покажем, что все $2n$ элементов этого набора различны и, следовательно, дают любой элемент группы $D_n$. 

Пусть $f_l^{\eps_1}f_{\ffi}^{k_1}=f_l^{\eps_2}f_{\ffi}^{k_2}$. Значит, $f_l^{\eps_1-\eps_2}f_{\ffi}^{k_1-k_2}=\id$.
Если $\eps_1=\eps_2$, то имеем $f_{\ffi}^{k_1-k_2}=\id$, что возможно только если $k_1=k_2$. Если же $\eps_1\neq \eps_2$, то будем считать $\eps_1-\eps_2>0$. Тогда $f_{l}=f_{\ffi}^{k_2-k_1}$. То есть поворот равен симметрии относительно прямой. Но такого не бывает, так как множество точек, остающихся на месте при симметрии -- это прямая. А множество точек, остающихся на месте относительно поворота: это либо точка, относительно которой поворачивают, либо всё пространство (в случае поворота на угол $0$).
\endproof

\item Рассмотрим группу $\GL_n(K)$ -- какие у неё образующие? Ответ прост -- это матрицы элементарных преобразований. Простое упражнение состоит в том, что матрицы, соответствующие транспозиции можно исключить из системы образующих.
\eenm

Как мы уже отметили, группы $\mb Z$ и $\mb Z/n$ --- циклические. Посмотрим ещё в этом направлении. Что происходит, когда мы берём подгруппу, порождённую произвольным элементом $g \in G$? 


\dfn Порядок элемента $g\in G$ --- это количество элементов в подгруппе $\lan g \ran$.
\edfn

\lm Пусть $g$ -- элемент $G$. Тогда если $\ord g$ конечен, то $\ord g=n$, где $n$ -- такое наименьшее натуральное число, что $g^n=1$. Если же порядок $g$ бесконечен, то не существует такого элемента $n\in \mb N$, что $g^n=1$. 
\elm
\proof Пусть $n$ --- такое, что $g^n=1$. Покажем, что $\ord g \leq n$. Рассмотрим элементы $1,g,g^2,\dots,g^n, \dots$. Заметим, что, начиная с $g^n$, все элементы этой последовательности будут повторяться. Точнее, если $m=nq+r$, где $0\leq r<n$, то
$$g^m=g^{nq+r}=g^r.$$
Этот же аргумент работает при отрицательном $m$. Так как подгруппа $\lan g \ran$ в точности состоит из элементов вида $g^i$, то мы установили, что различных среди них не более $n$ штук и все они имеют вид $g^r$, где $0\leq r < n$. 

Теперь если  $\ord g= \infty$ и одновременно $g^n=1$ при $n \in \mb N$, то предыдущее рассуждение приводит нас к противоречию. Действительно, условие $g^n=1$ означает, что в $\lan g\ran$ не более чем $n$ различных элементов. В частности, она конечна, что противоречит  $\ord g= \infty$.

Пусть теперь  $m=\ord g < \infty$, а $n$ -- наименьшее такое число, что $g^n=1$. Рассмотрим набор элементов $1,\dots,g^m$. Их $m+1$ штука и они лежат в $\lan g \ran$ где ровно $m$ элементов. Значит, среди них есть одинаковые. Пусть это $g^i=g^j$, где $0\leq j <i\leq m$. Домножим на $g^{-j}$ и получим, что $g^{i-j}=1$. Но тогда в $\lan g \ran $ не более $i-j$ элементов по предыдущему рассуждению. Такое бывает только если $i=m$ и $j=0$.  Отсюда видно, что $g^m=1$. К тому же это рассуждение показывает, что элементы $g^i$ при $0<i<m$ не могут быть равны 1. Тогда $n=m$. 

\endproof

Здесь в теореме мы снова пользовались тем, что если $g^n=1$, то в подгруппе, порождённой $g$, не более чем $n$ элементов. Сформулируем более точную версию этого утверждения, которая понадобится нам:

\utv Пусть $g\in  G$ и $g^n=1$ для $n\in \mb N$. Тогда $n \di \ord g$.
\eutv
\proof Пусть $m=\ord g$. Тогда $g^m=1$. Поделим с остатком: $n=mq+r$, где $0\leq r < m$. Тогда $1=g^n=g^{mq+r}=g^r$. Но если $r\neq 0$, то это противоречит определению $m$. Значит, $r=0$, что и требовалось.
\endproof









\thrm Пусть $g\in G$ -- элемент порядка $n\in \mb N$. Тогда циклическая группа $\lan g \ran $ изоморфна группе $\mb Z/n$. Если же $\ord g = \infty$, то $\lan g \ran$ изоморфна $\mb Z$.
\ethrm
\proof[Доказательство теоремы] Разберём сначала второй случай. Для этого докажем лемму: 
\lm Пусть $G$ группа, $g\in G$. Тогда существует такой единственный гомоморфизм $f \colon \mb Z \to G$, что $f(1)=g$.
\elm
\proof Для доказательства единственности заметим, что $f(n)$ должно быть равно $f(1)^n=g^n$. 

Итак, осталось показать, что заданное этой формулой отображение --  гомоморфизм групп. Но это равносильно базовым свойствам возведения в степень, которые мы уже обсуждали.
\endproof
\proof[Продолжение доказательства теоремы]
Пусть $\ord g=\infty$. Тогда построим гомоморфизм $\mb Z \to \lan g \ran$, переводящий $1$ в~$g$. В этом случае образ элемента $n \in \mb Z$ будет равен $g^n$. Значит, указанный гомоморфизм сюръективен, так как группа $\lan g \ran$ состоит ровно из степеней $g$. Осталось проверить инъективность. Предположим, что ядро $\Ker f \neq \{0\}$. Тогда есть число $0\neq n \in\Ker f $. Можно считать, что $n$ -- натуральное. Тогда $g^n=1$. Но это означает, что $\lan g \ran$ --- конечная подгруппа в $G$. Что противоречит условию. Значит, ядро тривиально.


Для доказательства в первом случае можно было бы сформулировать аналогичную лемму, но я не буду этого делать, а докажу напрямую.

Пусть $n=\ord g$. Построим отображение $f \colon\mb Z/n \to \lan g\ran $ по правилу $f(\ovl{k})=g^k$ (я тут специально напомнил, что в $\mb Z/n$ живут классы эквивалентности целых чисел).  Прежде всего необходимо проверить корректность такого определения, ведь выбор представителя $k$ может повлиять, априори, на $g^k$. 

Пусть $k_1\equiv k_2 \mod n$. Это значит, что $k_1=k_2+ns$. Но тогда $g^{k_1}=g^{k_2+ns}=g^{k_2}$. Значит, отображение определено корректно. Так же как и в случае с целыми числами, из свойств степени следует, что это гомоморфизм групп.   Осталось проверить, что это биекция. Для этого заметим, что элемент $g^k$ есть образ класса $k$. Это показывает сюръективность. Инъективность теперь следует из принципа Дирихле.
\endproof

Прервёмся на секунду и обсудим примеры подгрупп, порождённых подмножеством: прежде всего разберёмся с "модельной" циклической группой $\mb Z/n$.

\lm Пусть $k\in \mb Z/n$. Тогда $\ord k = \frac{n}{(n,k)}$. 
\elm
\proof Перепишем всё на языке сравнений. Нам надо найти наименьшее натуральное $d$, что $dk\equiv 0 \mod n$. Все решения этого сравнения имеют вид $d=\frac{n}{(n,k)}t$. Наименьшее натуральное решение получается при $t=1$, что и ожидалось.
\endproof

Изоморфизм сохраняет все свойства, которые можно выразить через групповую операцию. В частности, элементы порядка $n$ он переводит в элементы порядка $n$. Если $g$ -- это элемент порядка $n$, то циклическая подгруппа, порождённая им, изоморфна $\mb Z/n$. Отсюда автоматически следует: 

\crl Пусть $G$ -- группа, а $g\in G$ имеет порядок $n$. Тогда элемент $g^k$ имеет порядок $\frac{n}{(n,k)}$ 
\ecrl

А что будет, если взять целые числа? Понятно, что любой элемент внутри $\mb Z$, кроме $0$, имеет бесконечный порядок. Можно спросить поглубже, а чем вообще порождены подгруппы $\mb Z$? Оказывается, ответ довольно прост.

Для элементов группы $D_n$ легко посчитать их порядок: если это поворот, то он лежит в циклической группе, порождённой поворотом на $\frac{2\pi}{n}$, а если это симметрия, то порядок равен 2. Но как проверить, что порядок элемента  $g\in G$ равен $n$ для группы, которая задана не так явно, например, для группы $(\mb Z/n)^*$? Теоретически, можно возводить элемент $g$ подряд во все степени и смотреть, когда же $g^k=1$. Если перебирать таким образом, то может случиться, что вам придётся перебирать $|G|=n$ элементов (например, когда $G$ циклическая группа, а $g$ её порождает). Если $n=2^{2048}$, то такой перебор может и не закончиться. Следующая теорема говорит нам, как можно сэкономить в вычислениях:

\lm Пусть $g \in G$ такой, что $g^n=1$ для числа  $n=p_1^{\alpha_1}\dots p_k^{\alpha_k}$. Тогда если $g^{\frac{n}{p_i}}\neq 1$ для всех $i\in\ovl{1,k}$, то $n=\ord g$. 
\elm
\proof Пусть $m=\ord g$. Из условия $g^n=1$ мы знаем, что $m | n$. Пусть $m<n$. Тогда существует такой простой делитель $p_i$ числа $n$, что $n\di p_i^{\alpha_i}$, но $m\ndi p_i^{\alpha_i}$. Заметим тогда, что $n/p_i \di m$. То есть $n/p_i=mk$. Но тогда $g^{n/p_i}=g^{mk}=1$, что противоречит условию теоремы. Значит, $n=m$, что и требовалось.
\endproof

Посмотрим простейшие примеры того, как это утверждение работает. Рассмотрим элемент $2\in (\mb Z/13)^*$. Прежде всего я утверждаю, что $2^{12}=1$. Это следует из теоремы Эйлера. Простые делители $12$ -- это $2$ и $3$. Значит, для того, чтобы показать, что порядок элемента $2$ в группе $(\mb Z/13)^*$ равен 12 нам осталось проверить, что $2^{6}\neq 1$ и $2^4\neq 1$ в $\mb Z/13$. Что довольно легко делается.

Заметим, что так как в группе $(\mb Z/13)^*$ итак 12 элементов, то подгруппа $\lan 2\ran =(\mb Z/13)^*$. То есть $(\mb Z/13)^*$ -- циклическая.










\subsection{Подгруппы циклических групп}



\thrm Пусть $H$ -- подгруппа в циклической группе $G$, тогда $H$ -- циклическая. Более того, если $|G|=n$, то для любого $d|n$ существует единственная подгруппа $H\leq \mb Z/n$, что $|H|=d$. 
\ethrm
\proof

Рассмотрим сначала случай $G=\mb Z$. Это докажет нашу теорему в случае произвольной бесконечной циклической группы.

\lm Пусть $H$ подгруппа в $\mb Z$. Тогда $H$ -- циклическая.
\elm
\proof Мы уже проделывали это доказательство, когда говорили про наибольший общий делитель. Нам надо понять, что $H=\lan n\ran =n\mb Z$. Если $H=\{0\}$, то $n=0$. Иначе рассмотрим в $H$ наименьший натуральный элемент $n$. Покажем, что $H=n\mb Z$. Так как $n \in H$, то и $kn \in H$. Следовательно, получаем включение $n\mb Z \subseteq H$. Покажем обратное включение. Пусть $m\in H$. Поделим с остатком: $m=nq+r$, где $0\leq r<n$. Заметим, что тогда элемент $r=m-nq$ тоже лежит в $H$. Но если $r$ натуральный, то $r<n$ и мы приходим к противоречию с определением $n$. Значит,  $r=0$. То есть $m=nq \in n \mb Z$, что и требовалось. 
\endproof

Пусть теперь $|G|=n$. Тогда $G\simeq \mb Z/n$ и утверждение достаточно доказать для $\mb Z/n$. Вместо прямого доказательства, сведём указанное утверждение к уже известному аналогу для $\mb Z$. Для этого рассмотрим гомоморфизм $\pi\colon \mb Z \to \mb Z/n$ переводящий $x\to \ovl{x}$. Сведение теперь будет основано на лемме:

\lm Пусть $f\colon G_1\to G_2$ гомоморфизм групп и $H\leq G_2$. Тогда $f^{-1}(H)$ -- подгруппа в $G_1$.
\elm
\proof Проверим: $1 \in f^{-1}(H)$, то есть по определению, что $f(1)\in H$. Это так, потому что $f(1)=1\in H$. Аналогично, если $a=f^{-1}(x)$, где $x \in H$, то $f(a^{-1})=x^{-1}\in H$. Если же $f(a), f(b) \in H$, то $f(ab)=f(a)f(b)\in H$. 
\endproof

Итак, пусть $H\leq \mb Z/n$. Тогда, воспользовавшись леммой, получаем, что  $\pi^{-1}(H)$ ---  подгруппа в $\mb Z$. Но такая подгруппа циклическая, то есть $\pi^{-1}(H)=\lan k \ran$. У любого элемента $x\in H$ есть прообраз $a\in \pi^{-1}(H)=\lan k \ran$, так как $\pi$ сюръективно. Но тогда $x\in \lan \ovl{k} \ran$. То есть $H\subseteq \lan \ovl{k}\ran$. Обратное включение очевидно. Откуда вытекает, что $H$ -- циклическая.

Осталось показать существование и единственность подгруппы порядка $d$ для всех $d|n$.

Для данного $d$ предъявим подгруппу порядка $d$. Как мы уже показали, можно ограничиться циклическими подгруппами. То есть нужно предъявить элемент порядка $d$. Проще всего взять элемент $\frac{n}{d}$.

Покажем, что любая другая подгруппа $H$ порядка $d$ равна $\lan \frac{n}{d} \ran$. Пусть $H$ порождена элементом $x$ порядка $d$. Если отождествить $x$ с соответствующим целым числом, то условие на порядок записывается как  $d=\frac{n}{(n,x)}$, откуда $\frac{n}{d}=(n,x)$. Значит, $x$ кратен $\frac{n}{d}$. Но тогда $H \subseteq \lan\frac{n}{d}\ran$. Так как в обеих группах ровно $d$ элементов, то мы получаем равенство.
\endproof




\section{Классы смежности и теорема Лагранжа}

Из предыдущего раздела осталось несколько вопросов: откуда же взять изначальное условие $g^n=1$ для нахождения порядка элемента $g$? Почему в теореме про подгруппы циклической группы мы ограничились только теми подгруппами, порядок которых делит размер объемлющей группы? Оказывается это всё проявление некоторого общего принципа свойственного всем группам.


\dfn Пусть $H$ --- подгруппа $G$. Определим отношение эквивалентности $\sim_H$ на $G$ следующим образом: $g_1\sim_H g_2$ если $\exists h \in H$, что $g_1=g_2 h$.
\edfn

\utv Это отношение эквивалентности.
\eutv
\proof Действительно. Для того, чтобы показать, что $g\sim g$ возьмём $h=1$. 

Покажем симметричность. Если $g_1 \sim g_2$, то $g_1=g_2h$ для некоторого $h\in H$. Тогда $g_2=g_1h^{-1}$. Осталось заметить, что $h^{-1}\in H$. Покажем рефлексивность. Пусть $g_1\sim g_2 
\sim g_3$. При этом помогали им элементы $h_1$ и $h_2$ из $H$. То есть $g_1=g_2h_1$, $g_2=g_3h_2$. Но тогда подставив в первое равенство второе получим $g_1=g_3h_2h_1$. Значит, $g_1\sim g_3$. Что и требовалось. 
\endproof

Посмотрим как выглядят классы эквивалентности относительно $\sim_H$.

\dfn Пусть $G$ -- группа, $H$ -- подгруппа и задан некоторый элемент $g\in G$. Тогда множество $gH=\{ gh\,|\, h \in H\}$ является классом эквивалентности относительно $\sim_H$. Будем называть $gH$ левым смежным  классом элемента $g$ по подгруппе $H$. 
\edfn

\dfn Множество всех левых смежных классов будем обозначать $G/H$. Количество элементов в $G/H$ называется индексом $H$ в $G$  и обозначается $[G:H]$. 
\edfn

Благодаря тому, что отношение $\sim_H$ -- это отношение эквивалентности получаем, что



\crl Группа $G$ разбивается в дизъюнктное объединение левых смежных классов $$G=\coprod_{ gH \in G/H} gH.$$
\ecrl




\rm Аналогично определяется правый смежный класс $Hg$ для элемента $g$. Группа $G$ так же разбивается в диъюнктное объединение правых смежных классов. Множество правых смежных классов обозначается как $H\setminus G$.
\erm 

Это не всё, что нам нужно от смежных классов:

\utv Пусть $H$ -- подгруппа $G$ и $g\in G$ -- некоторый элемент. Тогда отображение $H \to gH$, заданное по правилу $h \to gh$, является биекцией.
\eutv
\proof Построим обратное отображение. Оно берёт элемент $x=gh\in gH$ и отправляет его в $g^{-1}x=h \in H $. Несложно проверить, что это взаимно обратные отображения.
\endproof

\dfn Пусть $G$ -- группа. Тогда число элементов в $G$ называют порядком $G$.
\edfn

\thrm[Лагранжа]  Пусть $G$ -- группа, $H$ -- подгруппа. Пусть порядок  $H$ конечен и индекс $[G:H]$ конечен. Тогда $G$ -- конечная группа и 
 $$|G|=|H|[G:H].$$
\ethrm
\proof По следствию из того, что $\sim_H$ -- отношение эквивалентности, получаем, что группа $G$ разбивается в дизъюнктное объединение левых смежных классов $$G=\coprod_{gH \in G/H} gH.$$
Таких смежных классов по определению $[G:H]$ штук. В каждом смежном классе $gH$ элементов столько же, сколько в $H$, то есть $|H|$. Но тогда число элементов в $G$ конечно и равно $|H|[G:H]$.
\endproof

\crl Пусть $G$ -- конечная группа, а $H$ -- её подгруппа. Тогда $|G| \di |H|$.
\ecrl
\proof В теореме Лагранжа даже сказано откуда берётся дополнительный множитель.
\endproof

\crl Пусть $G$ -- конечная группа. Тогда порядок элемента $g\in G$ делит $|G|$.
\ecrl
\proof Порядок $\ord g$ равен $|\lan g\ran|$. Но $\lan g\ran$ -- это подгруппа в $G$. Применим предыдущее следствие.
\endproof

\crl Пусть $G$ -- конечная группа порядка $n$, а $g$ -- её элемент. Тогда $g^n=1$.
\ecrl  
\proof По предыдущему следствию $n= \ord g \cdot m$, для $m\in \mb N$. Тогда $g^n=(g^{\ord g})^m=1^m=1$. 
\endproof

\crl Пусть $G$ -- конечная группа порядка $p$. Тогда $G$ циклическая и $G \simeq \mb Z/p$. 
\ecrl

\crl Пусть $G$ -- группа порядка $4$. Тогда либо $G \simeq \mb Z/2 \times \mb Z/2$, либо $G \simeq \mb Z/4$.
\ecrl



Некоторые старые факты удобно воспринимать в контексте теоремы Лагранжа.


\crl[Теорема Эйлера] Пусть $n$ -- натуральное число и $a\in \mb Z/n^*$. Тогда $a^{\ffi(n)}=1$.
\ecrl
\proof
Применим следствие из теоремы Лагранжа к группе $\mb Z/n^*$ и элементу $a\in \mb Z/n^*$.
\endproof

Про образующие $D_n$.




\section{Строение мультипликативной группы поля}

\dfn Пусть $R$ --- кольцо. Элемент $x\in R$ называется корнем степени $n$ из единицы, если $x^n=1$. Корень
степени $n$ из единицы называется первообразным, если $x^m\neq 1$ для любого $0<m<n$.
\edfn




Из предыдущей темы мы знаем, что кольцо $\mb Z/n$ для составного $n$ раскладывается в произведение множителей вида $\mb Z/p^{\alpha}$, и описывать группу обратимых элементов нам нужно только в этом случае. Начнём с самой простой ситуации: $\alpha=1$. В этом случае $\mb Z/p$ -- поле, а группа $\mb Z/p^*$ состоит из $p-1$ элемента. Утверждается, что эта группа циклическая. Для этого нам понадобятся несколько лемм из теории групп. 

\lm Пусть $n$ --- натуральное число. Тогда $n = \sum_{d|n}\varphi(d)$.
\proof  Рассмотрим циклическую группу $\mb Z/n$. Тогда если $d$ делит $n$, то в этой группе есть единственная подгруппа из $d$ элементов. Все элементы порядка $d$ лежат в этой подгруппе. Эта подгруппа циклическая. Следовательно, их $\ffi(d)$ штук. Тогда, сгруппировав все элементы одинакового порядка, получаем
$$n= |\mb Z/n |= \sum_{d|n} |\{ x \in \mb Z/n \,| \text{ $x$ элемент порядка $d$  }\}| = \sum_{d|n}\varphi(d).$$
\endproof
\elm

\lm Пусть $H$ --- такая конечная группа, что число элементов, удовлетворяющих равенству $x^d= 1$, не больше $d$. Тогда $H$ --- циклическая.
\elm
\proof Посчитаем число элементов в $H$. Обозначим его за $n$. Тогда
$$ n = \sum_{d|n} |\{ x \in H \,|\text{  $x$ элемент порядка $d$ в $H$} \}|.$$

Пусть  $x\in H$ порядка $d$. Тогда все элементы из подгруппы $\lan x \ran$ удовлетворяют тождеству $y^d=1$. Их $d$ штук. С другой стороны, по условию в $H$ не более $d$ элементов удовлетворяющих $y^d=1$. Рассмотрим $z \in H$ порядка $d$. Тогда он удовлетворяет $z^d=1$ и, значит, лежит в $\lan x \ran$. Но в $\lan x \ran$ как и в любой циклической группе элементов порядка $d$ ровно $\ffi(d)$. В частности, число элементов порядка ровно $d$ либо $0$, либо $\varphi(d)$, то есть всегда меньше или равно $\varphi(d)$. Тогда
$$n = \sum_{d|n} |\{x \in H \,| \text{  $x$ элемент порядка $d$ в $H$ } \}|\leq \sum_{d|n}\varphi(d) =n$$

Значит, неравенство обращается в равенство для каждого слагаемого. В частности, для того, которое соответствовало элементам порядка $n$. Значит, элементов в $H$ порядка ровно $n$ в точности $\varphi(n)$ штук. В частности, они
есть. Тогда группа $H$ порождена любым из них.\endproof


\thrm[Конечные подгруппы в мультипликативной группе поля] Пусть $H$ -- конечная подгруппа в $K^*$, где $K$ -- поле. Тогда $H$ циклическая.
\proof Решений уравнения $x^d-1 = 0$ в $K$ не более $d$ штук. Значит, их не более $d$ штук в подгруппе $H$. Применим предыдущую лемму.
\endproof
\ethrm

Применяя предыдущую теорему мы сразу же можем описать структуру мульпипликативной группы $\mb Z/ p^*$, где $p$ -- простое.

\crl Пусть $p\neq 2$ простое число. Тогда группа $\mb Z/p^*$ изоморфна циклической группе $\mb Z/(p-1)$.
\ecrl

\dfn Если $n\in \mb N$, то число $a$, такое что $\lan a\ran =\mb Z/n^*$ называется первообразным корнем по модулю $n$. Мы показали, что по модулю простого числа есть первообразные корни. Однако это редкость. Для большинства $n$ таких первообразных корней нет.  
\edfn


\section{Проблема дискретного логарифма и алгоритм Диффи-Хеллмана}

Обсудим, как наличие первообразного корня может быть  применено в криптографии. Основную задачу криптографии можно сформулировать так: передать сообщение от одного адресата другому, так, чтобы в случае доступа к каналу связи третьего человека, он не смог получить текст исходного сообщения. 

Точнее, третье лицо может получить только зашифрованное сообщение, по которому, по идее, не должно иметь возможность за разумное время восстановить исходное сообщение. С другой стороны, необходимо, чтобы получатель сообщения смог бы расшифровать полученное (не умерев от нетерпения).

Классические системы шифрования -- системы с закрытым ключом подразумевали, что участники заранее договариваются о закрытом ключе. При помощи этого ключа происходит шифрование и расшифровка. Однако часто у вас нет возможности договориться заранее. 

Решить эту проблему помогает алгоритм описанный в статье \href{https://www-ee.stanford.edu/~hellman/publications/24.pdf}{W. Diffie and M. E. Hellman, New Directions in Cryptography }. Этот алгоритм позволяет договориться об общем секретном ключе двум людям, используя только открытый канал связи.

\dfn
Пусть $G$ --- группа. Рассмотрим некоторый элемент $g\in G$. Тогда для любого $h\in \lan g\ran$ определено число $l$, что $g^l=h$ и $l\leq \ord g$. Такое число $l$ называется логарифмом $h$ по основанию $g$.
\edfn

Проблему дискретного логарифма можно поставить следующим образом. Пусть даны группа $G$, её элементы $g\in G$ и $h\in G$, про которые заведомо известно, что они лежат в $\lan g\ran$. Задача: найти логарифм $h$ по основанию $g$.


Рассмотрим некоторое конечное поле $K$. Нам известно, что группа $K^*$ является циклической. Пусть дан некоторый элемент $g\in K^*$, порождающий группу $K^*$. Тогда задача нахождения дискретного логарифма по основанию $g$ считается трудной. Это даёт возможность предложить  алгоритм для получения общего ключа.

Будем считать общеизвестными описание конечного поля $K$ и первообразный корень $g$ степени $m=|K|-1$. Например, $K=\mb Z/p$ и описание --- это просто задание простого числа $p$. Множество сообщений --- это множество чисел от 1 до $m$. Боб загадывает некоторое число $b\leq m$, а Алиса --- число $a\leq m$. Боб передаёт Алисе число $B=g^b$. Алиса передаёт Бобу $A=g^a$. Тогда оба они знают число 
$$A^b=g^{ab}=B^a,$$
которое и служит секретным ключом.
 

\section{Группа перестановок}

Попытаемся примерить все наши определения к группе перестановок. Прежде всего посчитаем порядок перестановки. Начнём со случая цикла


\dfn[Цикл] Пусть $a_1,\dots,a_k$ -- набор различных элементов из $\{1,\dots,n\}$. Тогда определим $c$ -- элемент из $S_n$, который мы будем называть циклом $(a_1,\dots,a_k)$, следующим образом:
$$c(x)=\begin{cases}
x,\, x \notin \{a_1,\dots,a_k\}\\
a_{i+1},\, x=a_i,\, 1\leq i < k\\
a_1,\, x=a_k
\end{cases}$$
\edfn

\utv Порядок цикла $(a_1,\dots,a_k)$ равен $k$.
\eutv
\proof Для того, чтобы цикл $c=(a_1,\dots,a_k)$ имел порядок $d$ нужно, чтобы $d$ было минимальным таким, что $c^d=\id$, то есть, чтобы после $d$ применений $c$ точки возвращались в себя. Точка $a_1$ возвращается в себя в первый раз после $k$ итераций. Как и все остальные точки из цикла. Точки отличные от $\{a_1,\dots,a_k\}$ и так переходят себя. Значит, $d=k$. 
\endproof

Сведём вычисление порядка для произвольной перестановки к вычислению для циклов. Для этого будут полезны следующие определения.

\dfn[Неподвижная точка] Если $\sigma \in S_n$, то тогда неподвижной точкой называется такой $x\in \{1,\dots,n\}$, что $\sigma(x)=x$. Множество всех неподвижных точек относительно $\sigma$ обозначим как $\Fix(\sigma)$ 
\edfn

\dfn[Носитель] Носителем перестановки $\sigma \in S_n$ называется множество $\supp \sigma$ = $\{1,\dots,n\}\setminus \Fix(\sigma)$
\edfn

\dfn[Независимость] Перестановки $\sigma_1,\sigma_2\in S_n$ называются независимыми, если $\supp \sigma_1 \cap \supp \sigma_2=\varnothing$.
\edfn

\rm Две независимые перестановки коммутируют, то есть $\sigma_1\sigma_2=\sigma_2\sigma_1$.
\erm

\thrm Пусть $\sigma \in S_n$. Тогда существует единственный с точностью до порядка набор независимых циклов $c_1,\dots,c_k$, что $c_i\neq \id$ и 
$$\sigma=c_1\dots c_k.$$
\ethrm
\proof Постараемся привести строгое доказательство. Пример применения алгоритма, стоящего за этим доказательством, смотри внизу. Рассмотрим отношение эквивалентности $\sim$ такое, что $x\sim y$, если существует $k\in \mb Z$, что $\sigma^k(x)=y$. Покажем транзитивность. Если $y=\sigma^k(x)$, а $z=\sigma^l(y)$, то $z=\sigma^l(\sigma^k (x))= \sigma^{l+k}(x)$.

Будем называть класс эквивалентности точки $x$ относительно этого отношения орбитой точки $x$ под действием $\sigma$. Она состоит из всех элементов вида $\sigma^k(x)$, $k \in \mb Z$.

Пусть $\Omega_1,\dots,\Omega_s$ -- это все различные орбиты. Определим перестановки $c_i$, где $i\in\ovl{1,s}$ следующим правилом:
$$c_i(x)=\begin{cases} \sigma(x), x\in \Omega_i\\
x, x\notin \Omega_i
\end{cases}.$$
Я утверждаю, что $c_i$ -- это независимые циклы. Прежде всего заметим, что носитель $c_i \subseteq \Omega_i$. Отсюда следует независимость.

Далее, если $\Omega_i$ состоит из $l$ элементов, то $c_i$ -- это цикл длины $l$ вида 
$$c_i=(x,\sigma(x),\dots,\sigma^{l-1}(x)), $$ где $x$ -- произвольный элемент из $\Omega_i$. Для этого необходимо показать, что это все элементы $\Omega_i$, что они все различны и что $\sigma^l(x)=x$.

Для этого заметим, что если $\sigma^i(x)=x$, для $i>0$, то в орбите $x$ не более чем $i$ элементов, так как, начиная с номера $i$, элементы $\sigma^k(x)$ начинают повторяться.

Предположим теперь, что $\sigma^i(x)=\sigma^j(x)$, где $0\leq j<i<l$. Но тогда, подействовав  $\sigma^{-j}$, получаем, что $\sigma^{i-j}(x)=x$. Но тогда по сделанному замечанию в $\Omega_i$ не более чем $i-j <l$ элементов. Значит, все элементы различные. 

Рассмотрим элемент $\sigma^l(x)$. Прежде всего заметим, что он совпадает с одним из элементов в наборе $x, \sigma(x),\dots,\sigma^{l-1}(x)$ по принципу Дирихле. Пусть с $\sigma^{i}(x)$. Если $i\neq 0$, то $\sigma^{l-i}(x)=x$ и в $\Omega_i$ меньше чем $l$ элементов. Противоречие. Значит, $i=0$ и $\sigma^l(x)=x$.

Итак, $c_i$ -- цикл. Покажем, что 
$$\sigma=c_1\dots c_s.$$
Пусть $x\in \Omega_i$. Заметим, что $\sigma(x)$ тоже лежит в $\Omega_i$. Посчитаем левую часть
$$c_1\dots c_s(x)=c_1\dots c_{i-1} (c_i(x))=c_1\dots c_{i-1} (\sigma(x))=\sigma(x),$$
так как циклы $c_j$ не переставляют элементы из $\Omega_i$ при $i\neq j$. Осталось выкинуть те циклы $c_i$, которые равны тождественной перестановке.

Единственность. Пусть $\sigma= c_1\dots c_k$ -- произведение независимых циклов. Тогда $\supp c_i$ совпадает с некоторой орбитой $\sigma$. Порядок следования элементов в $c_i$ определяется действием $\sigma$ на этой орбите, так как остальные $c_j$ оставляют точки этой орбиты на месте в силу независимости. 
\endproof

\rm Такое разложение в произведение независимых циклов практически единственно. Конечно, порядок циклов в таком разложении не определён однозначно. Также заметим, что в конструкции в теореме каждая недвижная относительно $\sigma$ точка $x$ даёт цикл $(x)$, который равен тождественной перестановке и, который, следовательно, можно выкинуть из этого разложения. 
Если эти циклы выкинуть, то разложение будет единственным с точностью до порядка сомножителей.
\erm

\exm \,Перестановка $\sigma=[2,3,1,4,6,5]$ может быть представлена следующим образом. Посмотрим куда переходит $1$ под действием $\sigma^k$. Получаем следующие переходы:
$$1\to 2\to 3 \to 1$$ 
$$4 \to 4 $$
$$ 5\to 6\to 5.$$
Итого: 
$$[2,3,1,4,6,5]=(123)(4)(56)=(123)(56).$$

\utv Пусть перестановка $\sigma \in S_n$ разложилась в виде произведения  независимых циклов $\sigma=c_1\dots c_k$. Обозначим длину цикла $c_i$  как $d_i$. Тогда $\ord \sigma= \Nok(d_1,\dots,d_k)$.
\eutv
\proof Благодаря тому, что независимые перестановки коммутируют получаем
$$\sigma^d=c_1^d\dots c_k^d$$

Заметим, что $c_i^d$ -- тоже независимые перестановки (хотя и не обязательно циклы). Поэтому $\sigma^d$  есть произведение независимых перестановок. Для того, чтобы $\sigma =\id$, необходимо и достаточно, чтобы $c_i^d=\id$. Но это происходит только если $d\di d_i$. Наименьшее такое $d$ -- это $\Nok(d_1,\dots,d_k)$.
\endproof

\utv[Обратный в цикловой записи] Пусть дан цикл $c=(a_1,\dots,a_k)$. Тогда $c^{-1}=(a_k,\dots,a_1)$. Если перестановка   $\sigma= c_1c_2\dots c_s$ представлена в виде произведения непересекающихся циклов $c_i$, то
$$\sigma^{-1}=c_1^{-1}c_2^{-1}\dots c_s^{-1}.$$
\eutv
\proof Утверждение для одного цикла понятно. Далее заметим, что циклы $c_i^{-1}$ так же независимы. Отсюда
$$\sigma^{-1}=c_s^{-1}\dots c_1^{-1}=c_1^{-1}\dots c_s^{-1}.$$
\endproof



Мы разобрались с циклическими подгруппами в $ S_n$. Но сама группа $S_n$ не циклическая (при $n\geq 3$) так как не абелева. Хотелось бы что-то сказать про образующие $S_n$. На текущий момент мы знаем, что множество всех циклов порождает $S_n$. Хочется уменьшить набор образующих.

\dfn[Транспозиция] Цикл вида $(ij)$ где $i\neq j$ называется транспозицией.
\edfn

\utv Любая перестановка представляется в виде произведения транспозиций.
\eutv
\proof Для этого достаточно научиться представлять циклы $(a_1,\dots,a_k)$. Но это легко сделать
$$(a_1 a_k)\dots( a_1 a_2)=(a_1,\dots,a_k)=(a_1a_2)\dots (a_{k-1} a_k)$$
\endproof
Здесь мы показали, что один и тот же цикл может быть двумя разными способами представлен в виде произведения транспозиций. Есть ли что-то общее у двух таких представлений?

\dfn[Инверсия] Будем говорить, что пара $i<j$  образует инверсию для перестановки $\sigma$, если $\sigma(i)>\sigma(j)$.
\edfn

\dfn[Чётность и знак] Чётностью перестановки будем называть чётность числа инверсий $Inv(\sigma)$ в ней. Знаком перестановки $\sigma$ будем называть 
$$\sgn(\sigma)=(-1)^{Inv(\sigma)}.$$
\edfn

\rm Знак перестановки можно задать другим способом: 
$$\sgn(\sigma)= \prod_{i>j} \frac{\sigma(i)-\sigma(j)}{i-j}.$$
Действительно, заметим, что знак выражения в правой части равен $(-1)^{Inv (\sigma)}$, так как сомножитель $\frac{\sigma(i)-\sigma(j)}{i-j}$ отрицателен, только если пара $i,j$ задаёт инверсию в $\sigma$.

Осталось показать, что получившееся выражение по модулю равно 1. Для этого перепишем его в виде 
$$\prod_{i>j} \frac{\sigma(i)-\sigma(j)}{i-j}= \frac{\prod_{i>j} (\sigma(i)-\sigma(j))}{\prod_{i>j}(i-j)}
$$
Сделаем в верхнем произведении "замену переменной". Представим $i=\sigma^{-1}(k)$, $j=\sigma^{-1}(l)$. Тогда верхнее произведение превращается в произведение 
$$\prod_{\sigma^{-1}(k)>\sigma^{-1}(l)} (k-l)$$
Видно, что это тоже произведение всех попарных разностей, только не обязательно из большего элемента в паре вычитается меньший. Итого по модулю это произведение равно $\prod_{i>j}(i-j)$, что  и требовалось.
\erm

\rm Удобно представить это выражение, как произведение по двухэлементным подмножествам.
$$\prod_{i>j} \frac{\sigma(i)-\sigma(j)}{i-j}=\prod_{\substack{\{i,j\}\\ i\neq j}} \frac{\sigma(i)-\sigma(j)}{i-j}$$
\erm
 

\lm Отображение $\sgn \colon S_n \to \{\pm 1\}$ является гомоморфизмом групп.
\elm
\proof Пусть $\sigma, \tau \in S_n$. Покажем, что $\sgn \sigma \tau = \sgn \sigma \sgn \tau$. Представим левую часть в виде произведения:
$$\sgn \sigma \sgn \tau= \prod_{\substack{\{k,l\}\\ k\neq l}} \frac{\sigma(k)-\sigma(l)}{k-l} \prod_{\substack{\{i,j\}\\ i\neq j}} \frac{\tau(i)-\tau(j)}{i-j}.$$
Сделаем замену в первом произведении: представим $k=\tau(i),l=\tau(j)$ для единственных $i,j$. Тогда если $\{k,l\}$ пробегает  все двухэлементные подмножества в $\{1,\dots,n\}$, то $\{i,j\}$ тоже пробегает все двухэлементные подмножества. Итого
$$\sgn \sigma \sgn \tau=\prod_{\substack{\{i,j\}\\ i\neq j}} \frac{\sigma(\tau(i))-\sigma(\tau(j))}{\tau(i)-\tau(j)} \prod_{\substack{\{i,j\}\\ i\neq j}} \frac{\tau(i)-\tau(j)}{i-j}$$
Сокращая знаменатели из первого произведения с числителями из второго, получаем как раз $\sgn \sigma \tau$.
\endproof

Перейдём к связи чётности и транспозиций.

\rm Заметим, что чётность транспозиции $(1,2)$ равна $-1$.
\erm

\lm Пусть $g\in S_n$. Тогда имеет место равенство перестановок. $g(1,2)g^{-1}=(g(1),g(2))$.
\elm
\proof Пусть $X=\{1,\dots,n\}$. Нарисуем диаграмму из отображений:
\begin{center}
\begin{tikzpicture}
\node (A) at (2, 0) {$X$};
\node (B) at (0, 0) {$X$};
\node (C) at (2, 1) {$X$};
\node (D) at (0, 1) {$X$};
\path[->,font=\scriptsize,>=angle 60]
(C) edge node[left]{$g$} (A)
(D) edge node[right]{$g$} (B)
(C) edge node[above]{$(1,2)$} (D)
(A) edge node[below]{$g(1,2)g^{-1}$} (B);
\end{tikzpicture}
\end{center}
Перестановка $g\colon X \to X$ сопоставляет новую нумерацию элементам из $X$. Итак, пусть есть некоторый элемент $k\in X$. Число $k$ -- это номер элемента $g^{-1}(k)$ в новой нумерации. Применяя далее к $g^{-1}(k)$ транспозицию $(1,2)$ мы получаем образ $g^{-1}(k)$ под действием $(1,2)$ в старой нумерации. Действуя $g$ переходим обратно в новую нумерацию. 
Таким образом, действует так же как и перестановка $(1,2)$ только с поменяной нумерацией. То есть как перестановка $(g(1),g(2))$.
\endproof

\rm Возможно проще вычислить в лоб, то есть посмостреть, куда по определению переходят $g(1)$ и $g(2)$ и все остальные элементы.
\erm

\crl Знак любой транспозиции равен $-1$.
\ecrl
\proof Пусть дана транспозиция $(i,j)$. Рассмотрим такую перестановку $g\in S_n$, что $g(1)=i$ и $g(2)=j$. Тогда $$\sgn((i,j))=\sgn(g(1,2)g^{-1})=\sgn g \sgn (1,2) (\sgn g)^{-1}=\sgn (1,2)=-1.$$ 
\endproof


\thrm Чётность перестановки $\sigma=\tau_1\dots \tau_k$, где $\tau_i$ -- транспозиции, равна $(-1)^{k}$.
\ethrm
\proof
$$\sgn(\tau_1\dots \tau_k)=\underbrace{(-1)\cdots (-1)}_{k \text{ раз }}=(-1)^k.$$

\endproof

\rm $\sgn \sigma = \sgn \sigma^{-1}$
\erm

Как посчитать знак (чётность) перестановки? Для этого удобно использовать представление перестановки в виде произведения непересекающихся циклов.

\utv Пусть $\sigma=c_1\dots c_k$, где $c_i$ независимые циклы. Тогда
$$\sgn \sigma = (-1)^{\text{число $c_i$ чётной длины}}.$$
\eutv
\proof Цикл длины $k$ раскладывается в виде произведения $k-1$ транспозиции. Значит, циклы нечётной длины дают сомножитель $1$, а циклы чётной длины сомножитель $(-1)$.
\endproof

Есть ещё один эквивалентный способ.
\utv Пусть $\sigma\in S_n$. Тогда
$$\sgn \sigma = (-1)^{n-k},$$
где $k$ -- это число орбит $\sigma$.
\eutv
\proof Множество точек $\{1,\dots,n\}$ разбивается в дизъюнктное объединение  $k$ орбит $\Omega_i$. Пусть $\Omega_i$ состоит из $k_i$ элементов. Получаем, что $\sum_{i=1}^{k} k_i=n$. Каждой орбите соответствует один цикл $c_i$ длины $k_i$ в разложении $\sigma$. Он раскладывается на $k_i-1$ транспозицию. Значит всего в разложении $\sigma$ необходимо взять $\sum_{i=1}(k_i-1)=n-k$ транспозиций. 
\endproof

В качестве примера, в котором важную роль играет понятие чётности перестановки посмотрим на игру в пятнадцать. Выглядит игра следующим образом: дан квадратик $4\times 4$ в пятнадцати клетках которого написаны все числа от 1 до 15, а оставшаяся пуста. Разрешается пустую клетку поменять с любой соседней местами.

$$\begin{array}{|c|c|c|c|}
\hline
1 & 2 & 3 & 4\\
\hline
5 & 6 & 7 & 8\\
\hline
9& 10& 11& 12\\
\hline
13& 14& 15&\\
\hline
\end{array}
$$

Обычно стартовая или финишная позиция для игры -- это указанная выше расстановка чисел. Будем называть её базовой расстановкой.
Далее в разных вариантах игр спрашивают разное. В первоначальной постановке мистер Ной Палмер Чепмэн, создатель головоломки, предлагал при помощи указанных правил из базовой расстановки получить магический квадрат, то есть такую расстановку, что сумма чисел в любой строке и любом столбце была бы одинакова. В таком виде игра в пятнадцать увидела свет в 1874 году в США и к 1880 году стала общеизвестной. 

Другая её вариация состояла в следующем: дана расстановка, которая отличается от базовой только тем, что числа 14 и 15 поменяны местами

$$\begin{array}{|c|c|c|c|}
\hline
1 & 2 & 3 & 4\\
\hline
5 & 6 & 7 & 8\\
\hline
9& 10& 11& 12\\
\hline
13& 15& 14&\\
\hline
\end{array}
$$

Требовалось предъявить такую последовательность ходов, которая переводит эту расстановку в базовую. За решение этой задачи было обещано вознаграждение.

Мы покажем, что решить эту задачу нельзя. Сопоставим каждой расстановке чисел перестановку из $S_{16}$. Прежде всего, вместо пустой клетки поставим число 16. Потом, выпишем числа из всех ячеек, в том порядке, который задаёт базовая перестановка, то есть перечисляя их слева направо, сверху вниз.

Теперь заметим, что если на данном шаге мы находимся в положении, соответствовавшем перестановке $\sigma$, то на следующем шаге, мы получим перестановку $\tau \sigma$, где $\tau$ -- транспозиция.

Пусть мы за $k$ шагов получили из расположения в котором поменяны 14 и 15 местами базовую расстановку. Это означает, что есть некоторые транспозиции $\tau_1,\dots, \tau_k$, что 
$$\id= \tau_1\dots \tau_k\,(14,15).$$
Сравнивая знак справа и слева получаем, что $1=(-1)^{k+1}$, то есть, что $k$ нечётно.

С другой стороны посмотрим на путешествие числа 16 (пустой клетки). В результате число 16 должно вернуться на место. Это означает, что перемещений вверх было столько же, сколько и перемещений вниз, а перемещений вправо столько же, сколько и перемещений влево. Но тогда в сумме число перемещений чётно. Противоречие!


Важным математическим объектом является само множество, а точнее группа чётных перестановок.

\dfn Знакопеременной группой $A_n$ называется
$$A_n=\{\sigma \in S_n\,|\, \sigma \text{ чётна } \} = \Ker \sgn \leq S_n.$$
\edfn

\rm Группа чётных перестановок состоит из $\frac{n!}{2}$ элементов.
\erm

\subsection{Образующие $S_n$ и $A_n$}

Наше рассмотрение понятия чётности началось с того, что мы пытались понять, какие перестановки порождают $S_n$. Попытаемся построить удобные порождающие системы для групп $S_n$ и $A_n$.

Прежде всего сформулируем общий факт про образующие, которым мы уже один раз неявно воспользовались

\utv Пусть $g_1,\dots,g_k $ -- образующие $G$. Для того, чтобы набор $h_1,\dots,h_l\in G$ порождал  $G$ необходимо и достаточно, чтобы все $g_i$ выражались через $h_1,\dots,h_k$. 
\eutv

\utv Группа $S_n$ порождена перестановками $(12), (1,3),\dots, (1,n)$
\eutv
\proof Мы уже знаем, что группа $S_n$ порождена транспозициями. Значит, надо при помощи транспозиций вида $(1i)$ получить произвольные транспозиции.  Имеем
$$(ij)=(1i)(1j)(1i).$$
Что и завершает доказательство.
\endproof

В этой системе образующих $n-1$ перестановка. Можно ли обойтись меньшим числом? Да. Но прежде докажем обобщение той конструкции, которую мы применили для вычисления знака транспозиции.

\utv Пусть $g\in S_n$ и $c=(a_1,\dots,a_k)\in S_n$. Тогда 
$$gcg^{-1}=(g(a_1),\dots,g(a_k)).$$
\eutv
\proof Достаточно дословно повторить аргумент с изменением нумерации.
\endproof

\utv Пусть $\sigma=c_1\dots c_k$ разложена в произведение независимых циклов. Тогда для любого $g\in S_n$
$$g\sigma g^{-1}= gc_1 g^{-1}\dots gc_kg^{-1},$$
есть произведение независимых циклов той же длины, что и у $\sigma$.
\eutv
\proof Равенство для $g\sigma g^{-1}$ очевидно. Так же ясно, что длины циклов $gc_i g^{-1}$ такие же как и у $c_i$. Осталось заметить, что если множества $\{a_1,\dots,a_k\}$ и $\{b_1,\dots,b_l\}$ не пересекались, то $\{g(a_1),\dots,g(a_k)\}$ $\{g(b_1),\dots,g(b_l)\}$ тоже не пересекаются. Это показывает, что $gc_i g^{-1}$ независимые циклы.
\endproof

В качестве завершающего аккорда покажем, что разложение на циклы одинаковой длины необходимо для существования такого $g$. Но сначала пара определений.
\dfn Пусть $\sigma \in S_n$. Тогда её цикленным (или цикловым) типом называется набор упорядоченных пар $(1,k_1),\dots, (n,k_n)$, где $k_i$ -- это число орбит размера $i$ относительно $\sigma$. В этом определении фигурируют именно орбиты, чтобы избежать неоднозначности связанной с циклами длины один.
\edfn

\dfn Пусть $G$ -- некоторая группа. Если $g,h\in G$, то элемент $ghg^{-1}$ называется сопряжённым к $h$ при помощи $g$. Два элемента $h_1$ и $h_2$ называются сопряжёнными, если существует $g \in G$, что $gh_1g^{-1}=h_2$.
\edfn 

\thrm Две перестановки $\sigma_1,\sigma_2\in S_n$ сопряжены тогда и только тогда, когда у них одинаковые цикленные типы.
\ethrm
\proof Надо лишь показать, что одинаковы цикленные типы для перестановок означают, что они сопряжены. Предъявим алгоритм построения перестановки $g$. Для этого выпишем все циклы в $\sigma_1$ в порядке возрастания их длины, не исключая циклы длины 1. Аналогично сделаем для $\sigma_2$. 
$$\sigma_1=(a_1)\dots(a_s)(a_{s+1}a_{s+2})\dots (a_{n-t}\dots a_n)$$
$$\sigma_2=(b_1)\dots(b_s)(b_{s+1}b_{s+2})\dots (b_{n-t}\dots b_n)$$
Под циклом длины $k$ в $\sigma_1$ расположен цикл длины $k$ в $\sigma_2$. Положим $g(a_i)=b_i$. Так как наборы из $a_i$ и из $b_i$ содержат каждый элемент из $\{1,\dots,n\}$ по одному разу, то получилась перестановка. Очевидно $g\sigma g^{-1}=\sigma_2$.
\endproof

Вернёмся к образующим симметрической группы.

\utv Группа $S_n$ порождена перестановками $(12), (1 \dots n)$. 
\proof Выразим перестановки $(1i)$ через данные. Вначале умножим $(12)(12\dots n)=(2\dots n)=\gamma$. Теперь
$$\gamma^{i-2}(12)\gamma^{-(i-2)}=(1i).$$
\endproof
\eutv

Теперь получим набор образующих для $A_n$. Доказательство так же будем вести по индукции.


\thrm Группа $A_n$ порождена циклами $(123),\dots,(12n)$. 
\ethrm
\proof При $n=3$ утверждение очевидно. Возьмём теперь $\sigma\in A_n$ и пусть $\sigma(n)=i$. Заметим, что перестановка $(12n)^2(12i)$ переводит $i\to n$. Тогда $\sigma'=(12n)^2(12i) \,\sigma$ лежит в  $A_{n-1}$, так как она $n$ переводит в $n$ и является чётной, как произведение чётных перестановок. Но по индукционному предположению $\sigma'$ выражается через $(123),\dots,(12\,n-1)$. Значит исходная перестановка выражается через $(123),\dots,(12n)$.
\endproof


\utv Группа $A_n$ порождена циклами $(123),\dots,(12\dots n)$, если $n$ нечётно  и  $(123),\dots,(2\dots n)$, если $n$ чётно.
\proof В случае нечётного $n$ рассмотрим произведение $(123)^{-1}(12\dots n)=(3\dots n )= \gamma$. Теперь при помощи $\gamma$ получим 
$$\gamma^{i-3}(123)\gamma^{-(i-3)}=(12i).$$
Для чётных $n$:
$$\gamma_i= (2\dots n)^{i-2} (123)(2\dots n)^{-(i-2)}=(1, i,i+1).$$
Теперь 
$$\delta_i=\gamma_{i+1}\gamma_i \gamma_{i+1}^{-1}= (1, i+1,i+2)(1, i,i+1)(1, i+1,i+2)^{-1}=(i+1,i,i+2)=(i,i+2,i+1).$$
Теперь, если мы получили $(12i)$, то получим и $(1,2, i+1)$. Точнее
$$\delta_i^2 (12i)\delta_i^{-2}=(1,2,i+1).$$
При $i+1=n$ стоит воспользоваться $\delta_{i-1}$. Заметим, что это доказательство не работает для $A_4$. Здесь нужно повозиться руками.
\endproof
\eutv


\upr Придумайте доказательство, которое работает в чётном случае лучше (В частности, в случае $A_4$).
\eupr



\section{Разложение в произведение}
Представим себе, что вам дана группа, например как подгруппа в $S_n$ заданная некоторыми образующими. Можно ли как-то упростить её представление? Главный вопрос здесь, что значит упростить. Я предлагаю считать упрощением тот факт, что группа изоморфна прямому произведению. Действительно, пусть 
$$G\cong G_1 \times G_2.$$
Тогда, если  $G$ конечная, то $|G|=|G_1|\cdot |G_2|$. В частности, если обе группы $G_1$ и $G_2$ нетривиальны, то $|G_1|< |G|$ и $|G_2|<|G|$, что уже свидетельствует о некотором упрощении. Покажем ещё несколько результатов в этом направлении.

\utv Пусть $(g,h)\in G_1\times G_2$. Тогда $\ord (g,h)= \Nok(\ord g, \ord h)$.
\eutv
\proof По определению произведения $(g,h)^d=(g^d,h^d)$. Эта пара равна $(1,1)$ только если $g^d=1$ и $h^d=1$. Первое условие означает, что $d\di \ord g$, а второе, что $d\di \ord h$. То есть $d\di \Nok(\ord g, \ord h)$. Наименьшее такое $d$ и есть $\Nok(\ord g, \ord h)$.
\endproof

Произведение $G_1\times G_2$ содержит внутри себя подгруппы $G_1\times \{1\}$  и $\{1\}\times G_2$. Первая -- это фактически $G_1$, а вторая -- это $G_2$. Будем обозначать эти подгруппы просто как $G_1$ и $G_2$. Такое замечание позволяет построить образующие $G_1\times G_2$, если известны образующие для $G_1$ и $G_2$.

\thrm Пусть $g_1,\dots,g_k$ образующие $G_1$, а $h_1,\dots,h_l$ образующие $G_2$. Тогда $(g_1,1), \dots, (g_k,1), (1,h_1),\dots,(1,h_l)$ -- это образующие $G_1\times G_2$.
\ethrm
\proof Рассмотрим пару $(g,h)$. Она представлена в виде произведения двух пар $(g,h)=(g,1)(1,h)$. Представим элемент $g$ в виде $g=g_{i_1}^{\eps_1}\dots g_{i_s}^{\eps_s}$ -- это даст аналогичное разложение для $(g,1)$. Так же для $(1,h)$.
\endproof

Осталось только понять как извлечь из группы $G$ информацию про то, изоморфна ли она прямому произведению каких-то групп. Предположим, что так произошло и $G\cong G_1\times G_2$. Внутри $G_1\times G_2$ есть подгруппы $G_1\times \{e\}$ и $\{e\}\times G_2$, изоморфные $G_1$ и $G_2$ соответственно. Тогда внутри $G$ должны быть подгруппы изоморфные $G_1$ и $G_2$. Это сразу означает, что кандидаты на сомножители мы должны искать среди подгрупп в $G$. На самом деле, можно заметить, что так как в произведении произвольная пара $(g,h)=(g,e)(e,h)$ есть произведение элементов из $G_1\times \{e\}$ и $\{e\}\times G_2$, то аналогичное условие выполнено и для $G$. Это приводит к определению

\dfn Будем говорить, что группа $G$ раскладывается в виде произведения своих подгрупп $G_1$ и $G_2$, если отображение
$$f\colon G_1\times G_2 \to G$$
$$\quad (g,h)\to gh$$
является изоморфизмом. Будем записывать этот факт как $G=G_1\times G_2$.
\edfn

Какие свойства необходимо наложить на подгруппы $G_1$ и $G_2$, чтобы $G$ разложилось в их прямое произведение.Заметим, что свойства этих подгрупп должны быть такие же, как и у $G_1\times \{e\}$ и $\{e\}\times G_2$ в $G_1\times G_2$. Сформулируем их:\\
1) $G_1\times \{e\} \cap \{e\}\times G_2 =\{(e,e)\}$. Действительно, у элемента пересечения каждая компонента равна $e$.\\
2) Если $(g,e)\in G_1\times \{e\}$, а $(e,h)\in \{e\}\times G_2$, то $(g,e)(e,h)=(e,h)(g,e)$. Это верно, потому что оба произведения равны $(g,h)$.\\
3) Любой элемент из $G_1\times G_2$ есть произведение элемента из $G_1\times \{e\}$  и элемента из $\{e\}\times G_2$. Запишем это в ослабленном виде $\lan G_1\times \{,G_2\ran = G_1\times G_2$.\\

Итак, если группа $G$ изоморфна произведению двух подгрупп, то в ней должны быть подгруппы с указанными свойствами. Оказывается, что этих свойств и достаточно.

\thrm Пусть даны две подгруппы $G_1,G_2 \leq G$. Тогда $G_1\times G_2=G$, тогда и только тогда, когда\\
1) $G_1\cap G_2 =\{1\}$.\\
2) Если $g\in G_1$, а $h\in G_2$, то $gh=hg$.\\
3) $\lan G_1,G_2\ran = G$.
\ethrm
\proof Проверим, что указанное отображение есть гомоморфизм. Пусть $g_1,g_2 \in G_1$, а $h_1,h_2\in G_2$. Тогда образ $$f((g_1,h_1)(g_2,h_2))=g_1g_2 h_1h_2.$$
С другой стороны перемножая образы произведения получаем 
$$f((g_1,h_1))f((g_2,h_2))=g_1h_1 g_2h_2.$$
Осталось заметить, что центральные элементы можно переставить благодаря условию 2).

Покажем, то что $f$ -- мономорфизм. Для этого заметим, что пара $(g,h)\in \Ker f$, если $gh=1$, то есть $g=h^{-1}$. Но правая часть лежит в $G_1$, а левая -- в $G_2$. Благодаря условию на пересечение мы знаем, что это единичный элемент. То есть $g=h=1$. Значит ядро  тривиально. 

Покажем сюръективность. Заметим, что образ при гомоморфизме  -- это подгруппа. В данном случае, это подгруппа в  $G$ и она содержит $G_1$ и $G_2$. Но тогда по третьему условию образ равен  $G$.
\endproof

\rm Условие 3) равносильно тому, что любой элемент из $G$ раскладывается в виде произведения $gh$, где $g\in G_1$, а $h\in G_2$ (если есть второе условие). Так же условия 1) и 3') можно заменить на условие, что разложение вида $gh$ единственно.  
\erm

\exm \enm
\item Пусть $H=\lan (123) (56), (124)(67)\ran \leq S_7$. Покажем, что $H$ раскладывается в произведение двух групп. Прежде всего поменяем набор образующих у $H$. Пусть $h=(123) (56)$, а $g=(12)(678)$. Тогда $h^3=(56)$ И, значит, циклы $(56)$, $(123)$ по отдельности тоже лежат в $H$. Аналогично
с $(12)$ и $(67)$. Значит $H$ порождена
$$H=\lan (123),(56), (124), (67)\ran.$$
Теперь легко заметить две подгруппы в $H$, в произведение которых она раскладывается: $H_1=\lan (123), (124)\ran$ и $H_2=\lan (56), (67)\ran$. Действительно, так как образующие из $H_1$ независимы с образующими $H_2$, то все возможные элементы из $H_1$ и $H_2$ коммутируют  между собой, а все элементы из пересечения обязаны совпадать с тождественной перестановкой. Понятно, что $H$ порождена $H_1$ и $H_2$.

Теперь, неплохо бы понять, чему изоморфны $H_1$ и $H_2$. Заметим, что $H_1$ это в точности $A_4$. Проще всего это понять, увидев в образующих $H_1$ образующие $A_4$. Но можно это сделать используя косвенные аргументы: заметим, что порядок $H_1$ делится на $3$ по теореме Лагранжа так как группа содержит элемент порядка $3$. С другой стороны, произведение $(123)(124)=(13)(24)$ и сопряжение $(123) (13)(24)(123)^{-1}=(12)(34)$ дают две образующих подгруппе $V_4=\{\id, (12)(34), (13)(24), (14)(23)\}$.  Это означает, что $|H_1|\di 4$ и отсюда $|H_1|\di 12$. Но $H_1 \leq A_4$, в которой итак 12 элементов. Значит имеет место равенство

В свою очередь $H_2\simeq S_3$, как группа перестановок на элементах $5,6,7$. Отсюда $H\cong A_4 \times S_3$.
\item Не только независимость приводит к тому, что перестановки в $S_n$ коммутируют. Пусть $$H=\lan (12)(34)(567), (13)(24)(5678)\ran=\lan (12)(34), (567), (13)(24)(5678)\ran ,$$
то перестановки $g=(12)(34)$ и $h=(13)(24)(5678)$ коммутируют, что проверяется непосредственно. Теперь несложно показать, что $$H\cong \lan (12)(34) \ran \times \lan (13)(24)(5678), (567) \ran.$$
Первая группа изоморфна циклической группе $\mb Z/2$. А про  вторую можно утверждать, что она изоморфна $S_4$. Для этого покажем, что элемент из $\sigma \in H_2$, действующий тождественно на $5,6,7,8$ должен быть тривиальным. Посмотрим на чётность. Если записать $\sigma$ как произведение образующих, то образующая $(13)(24)(5678)$ входит в это разложение чётное число раз. Но тогда на элементах $1,2,3,4$ перестановка $\sigma$ действует тривиально. Итак, перестановка из $H_2$ определяется своим действием на $5,6,7,8$. Но несложно понять, что любая перестановка этих элементов реализуется (так как что-то является образующими чего-то).
\eenm



\subsection{Структура $\mb Z/n^*$}

Если $n=p_1^{\alpha_1}\dots p_k^{\alpha_k}$, то мы уже знаем, что 
$$\mb Z/n^* \cong \mb Z/^*p_1^{\alpha_1}\times \dots \times \mb Z/^* p_k^{\alpha_k}.$$
Итого надо разобраться со степенью простого. Для этого нам понадобится техническая лемма.



\lm Пусть $p$ простое, а $s\geq 1$ при $p$ нечётном и $s\geq 2$ при $p=2$. Тогда  что если $$x \equiv 1+cp^s \mod p^{s+1}, \text{ то } (1+cp)^p\equiv 1+cp^{s+1} (\mod p^{s+2}).$$
\elm
\proof Мы знаем по предположению, что $x=1+p^s(c+rp)$. Тогда $$x^p=(1+p^s(c+rp))^p=1+pp^s(c+rp)+C_p^2p^{2s}(c+rp)^2+\dots+p^{ps}(c+rp)^{p}\equiv 1+cp^{s+1} \mod p^{s+2}.$$
\endproof



\utv Пусть  $p$ -- нечётное простое. Тогда $\mb Z/^*p^{\alpha}$ изоморфна циклической группе 
$$\mb Z/p^{\alpha-1} (p-1) \cong \mb Z/(p - 1) \times \mb Z/p^{\alpha-1}.$$
Если же $p=2$, то если $\alpha = 1$, то группа $\mb Z/p^{\alpha}$ тривиальна.\\
2) если $\alpha \geq 2$, то $\mb Z/^*p^{\alpha}$ изоморфна произведению $ \mb Z/2 \times \mb Z/2^{\alpha-2}$.
\eutv
\proof
Пусть $p$ -- нечётное. Рассмотрим подгруппу $H_1=\{ x\equiv 1 \mod p\}$. Её порядок $p^{\alpha -1}$. Я утверждаю, что она порождена $1+p$. Для этого проверим, что порядок $1+p$ не меньше $p^{\alpha-1}$. Для этого надо проверить, что $(1+p)^{p^{\alpha-2}} \not\equiv 1 \mod p^{\alpha}$. Но это так -- последовательно используя лемму получаем, что
$$(1+p)^{p^{\alpha-2}}\equiv 1+p^{\alpha-1}\not\equiv 1 \mod p^{\alpha}.$$
Значит $H$ -- циклическая. Посмотрим теперь, откуда берётся циклическая подгруппа из $p-1$ элемента. Для этого рассмотрим $g$ -- первообразный корень степени $p-1$ в поле $\mb Z/p$. В частности, $g$ удовлетворяет уравнению $g^{p-1}-1=0$. По лемме Гензеля у решения этого уравнения есть подъём до решения $\hat{g}$ по модулю $p^{\alpha}$. Это значит, что $\hat{g}^{p-1}-1=0$ в $\mb Z/p^{\alpha}$ и $\hat{g}\equiv g \mod p$. Первое условие говорит, что порядок $g$ есть делитель $p-1$, а второе -- что это ровно $p-1$.

Итак в $\mb Z/^*p^{\alpha}$ есть две подгруппы $H_1=\lan 1\ran$ и $H_2=\lan \hat{g} \ran$. Так как порядки этих подгрупп взаимно просты, то сами подгруппы пересекаются только по нейтральному. Порядок подгруппы, их содержащей  должен делиться на $p-1$ и $p^{\alpha-1}$, то есть на $(p-1)p^{\alpha-1}$, откуда следует, что $H_1$ и $H_2$ порождают всю группу. Коммутативность так же имеет место. Итого, группа разложилась в произведение.

С $\mb Z/2^{\alpha}$ поступим так же. Случай $\alpha=1,2$ понятны. Рассмотрим подгруппу $H_1=\{\pm 1\}$ в $(\mb Z/2^\alpha)^*$. Если $\alpha\geq 3$, то в $(\mb Z/2^\alpha)^*$ есть нетривиальная подгруппа 
$$H_2=\{ x\in \mb Z/2^\alpha\,|\, x \equiv 1 \mod 4\}.$$
Покажем, что $(\mb Z/2^\alpha)^* =H_1 \times H_2$. Действительно, так как $-1\not\equiv 1 \mod 4$, то пересечение состоит из единичного элемента. Все элементы коммутируют так как мы находимся внутри абелевой группы. Для того, чтобы проверить третье условие заметим, что если $x\in (\mb Z/2^\alpha)^*$, что $x\equiv 1\mod 4$, то он и так лежит в $H_2$, а если $x\equiv -1 \mod 4$, то $x$ лежит в $(-1)H_2$.

Осталось понять, что $H_2$ -- циклическая. Рассмотрим элемент $5=1+4\in H_2$. Используя лемму получим, что $\ord 5 = 2^{\alpha-2}$, что и требовалось. 

\endproof

Подведём итог: 

\crl[Ответ в зависимости от разложения] Пусть $n=2^kp_1^{\alpha_1}\dots p_s^{\alpha_s}$. Тогда\\
1) если $k = 0,1$, то  $\mb Z/n^*$ изоморфна $$\prod_{i=1}^s \mb Z/p_i^{\alpha_i-1}(p_i -1).$$
2) если $ k\geq 2$, то $\mb Z/n^*$ изоморфна $$\mb Z/2 \times \mb Z/2^{k-2} \times \prod_{i=1}^s \mb Z/p_i^{\alpha_i-1}(p_i -1).$$
\ecrl

\subsection{Доказательство теоремы Рабина}

\thrm[Рабин] Пусть $n$ нечётное составное число,  $n>9$. Тогда $S(n)\leq \frac{\varphi(n)}{4}$, где $S(n)$ -- множество свидетелей простоты в тесте Миллера-Рабина.
\ethrm
\proof Пусть $n=p_1^{\alpha_1}\dots p_k^{\alpha_k}$, а $n-1=2^sd$, где $d$ -- нечётно. Покажем, что $S(n)$ лежит в некоторой подгруппе внутри $\mb Z/n^*$ индекса по крайней мере $4$.

Для этого рассмотрим  такое наибольшее $l$, что для любого $p_i$ существует $b$, что $b^{2^l}=-1 \mod p_i$ (понятно, что такое есть). Рассмотрим теперь $m=2^ld$ и подгруппы $$H=\{ x\,|\, x^m\equiv \pm 1 \mod n\}, \quad H_1=\{ x\,|\, x^m \equiv \pm 1 \mod p_i^{\alpha_i} \,\,\forall i\}.$$
Очевидно, $H \leq H_1$. Заметим, что $S(n) \subseteq H$. Действительно, если $a\in S(n)$, то $(a^d)^{2^r}= -1$, либо $a^d=1$, что нас и так устраивает.  Но тогда, взяв $b=a^d$ получим, что $l\leq r$ так как $l$ -- наибольшее.

Посчитаем индекс $H \leq H_1$. Удобно посмотреть на $H_0= \{ x^m \equiv 1 \mod n$. Понятно, что $H_0 \leq H$ -- подгруппа индекса 2. Посчитаем индекс $H_0$ в $H_1$ Для этого заметим, что в $H_1$ реализуется любая из $2^k$ комбинаций знаков в сравнениях (благодаря определению в $l$). Каждая такая комбинация соответствует смежному классу. Теперь получаем, что индекс $$[H_1:H]=[H_1:H_0]/[H:H_0]=2^{k-1}$$
Итого: при $k\geq 3$ теорема доказана. Пусть $k=2$. Тогда $x=p_1^{\alpha_1}p_2^{\alpha_2}$. Рассмотрим случай, когда есть кратные множители, то есть, скажем, $\alpha_1\geq 2$. В этой ситуации в $\mb Z/n^*$ есть элемент порядка $p_1^{\alpha_1-1}$. Но нет в $H_1$, так как порядки элементов $H_1$ делят $2m$. Итого $H_1 \neq \mb Z/n^*$ и общий индекс $[\mb Z/n^*: H]=[\mb Z/n^*:H_1][H_1:H]\geq 4$.

Пусть теперь $n=p_1p_2$. Заметим, что любой элемент из $H_1$ удовлетворяет свойству $x^{n-1}=1$. Для этого надо показать, что $n-1 \di 2m=2^{l+1}d$. Заметим, что все простые $p_i$ имеют вид $p_i=1+2^{l+1}$, потому что по модулю каждого простого есть элемент порядка $2^{l+1}$. Но тогда и $n=1+2^{l+1}$. Тогда $n-1\di 2^{l+1}$ и $n-1\di d$. Отсюда получаем, что $n-1 \di 2m$. Заметим теперь, что в $Z/n^*$ есть элемент порядка $p_2-1$. Покажем, что его нет в $H_1$ так как он не удовлетворяет условию $x^{n-1}=1 \mod n$. Посмотрим на $n-1 \mod p_2-1$. Имеем $$n-1=p_1p_2-1\equiv p_1-1 \mod p_2-1.$$
Значит $(n-1,p_2-1)=(p_1-1,p_2-1)<p_2-1$. Значит в $H_1$ нет элемента порядка $p_2-1$ и приходим к оценке индекса $H$ в $H_1$.

Последний случай: $n=p^{\alpha}$. Тогда, если $p\geq 5$, то работает аргумент про элемент порядка $p$. Если $p=3$, то по нашему условию $\alpha\geq 3$ и снова можно учесть что в $H_1$ нет элемента порядка $p^{\alpha-1}$.

\endproof


\upr $S(n)$ -- не подгруппа в $\mb Z/n^*$.
\eupr

\subsection{Дополнение: другое доказательство теоремы Рабина}

Вообще, коль скоро мы знаем строение $\mb Z/n^*$, то можно просто влоб подсчитать число элементов в $S(n)$ и вывести отсюда теорему Рабина. Можно посмотреть, что из этого получается.

\begin{thmm}[Рабин] Пусть $n$ нечётное составное число,  $n>9$. Тогда $|S(n)|\leq \frac{\varphi(n)}{4}$.
\end{thmm}
\proof Пусть $n$ -- это $p_1^{\alpha_1}\dots p_k^{\alpha_k}$, а $n-1=2^rd$. Тогда группа $\mb Z/n^*$ изоморфна группе
$$ \prod_{i=1}^k \mb Z/p_i^{\alpha_i-1}(p_i -1).$$
Видно, что в задаче выделенную роль играет степень двойки. Пусть $p_i-1=2^{s_i}r_i$. Тогда группа $\mb Z/p_i^{\alpha_i-1}(p_i -1)$ изоморфна 
$$\mb Z/2^{s_i}\times \mb Z/p_i^{\alpha_i-1}r_i.$$
Итого имеем 
$$\mb Z/n^*\cong \prod \mb Z/2^{s_i} \times \mb Z/p_i^{\alpha_i-1}r_i.$$ 
Рассмотрим элемент $x\in \mb Z/n^*$ и посмотрим, что же означает условие, что $x^m=1$ или $x^{2^sm}=-1$ для его компонент. 
Для того, чтобы $y=-1$ необходимо и достаточно, чтобы все его компоненты в группах $\mb Z/2^{s_i}$ были единственным элементом порядка $2$, а все компоненты в группах $\mb Z/p_i^{\alpha_i-1}r_i$ были равны 0 (здесь используется аддитивная запись).

Для начала посмотрим на компоненты в группах $\mb Z/p_i^{\alpha_i-1}r_i$. Если $2^smb=0 (\mod p_i^{\alpha_i-1}r_i)$, то это означает, что порядок $b$ делит $2^{s_i}m$. Множество таких элементов образует подгруппу порядка $\Nod(2^{s_i}m,r_ip_i^{\alpha_i-1})=\Nod(m,r_i)$, так как $(p_i,2^{s_i}m)=1$ и $(r_i,2^{s_i})=1$.

Теперь рассмотрим произведение $\prod \mb Z/2^{s_i}$. То, что элемент $2^{s}mx$ имеет порядок 2 $(\mod \mb Z/2^{s_i})$ означает, что $x$ имеет порядок $2^{s+1}$. Таким образом $T$ принадлежат только те элементы чьи компоненты в $\mb Z/2^{s_i}$ имеют одинаковый порядок для всех $i$.

Сколько таких элементов в $\prod \mb Z/2^{s_i}$? Рассмотрим $l= \min_{i=1}^k s_i$. Тогда порядок каждой компоненты элемента не может превосходить $2^l$ -- он не может получиться одинаковым по всем компонентам. Сколько элементов, которые имеют порядок $2^l$ по каждой компоненте? Их $2^{(l-1)k}$ штук. Аналогично элементов, чьи компоненты порядка  $2^i$ ровно $2^{(i-1)k}$ штук. Итого
$$\sum_{i=1}^l 2^{(i-1)k}= \frac{2^{lk}-1}{2^k-1}.$$ Заметим, что ещё есть первое условие которое подходит только для нейтрального элемента. Итого из сомножителя $\prod \mb Z/2^{s_i}$  подходящих нам вариантов ровно $$\frac{2^{lk}-1}{2^k-1}+1\leq 2\cdot 2^{k(l-1)}.$$
В случае $k,l\neq 1$ можно поставить строгое неравенство. Объединяя, получаем, что всего элементов в $T$ не более
$$2\cdot 2^{k(l-1)}\prod_i\Nod(r_i,m).$$
Покажем, что 
$$\frac{|S(n)|}{\ffi(n)}\leq 2\frac{ 2^{k(l-1)}\prod_i\Nod(r_i,m)}{(p_i-1)p_i^{\alpha_i-1}}\leq \frac{1}{4}.$$
Прежде всего заметим, что выражение $2^{l-1}\Nod(r_i,m)$ делит $\frac{p_i-1}{2}$.
Тогда можно написать оценку
$$2\frac{ 2^{k(l-1)}\prod_i\Nod(r_i,m)}{(p_i-1)p_i^{\alpha_i-1}}\leq \frac{2}{2^k}\prod \frac{1}{p_i^{\alpha_i-1}}.$$
Получаем, что если простых сомножителей не меньше 3-ёх, то неравенство выполнено. Действительно -- в знаменателе возникает множитель $8$, который может сократиться только с одной двойкой сверху. 

Рассмотрим случай, когда различных простых ровно 2. Заметим, что, если есть кратные множители то в последнем множителе есть не единичный элемент в знаменателе. 

Итак остался случай, когда есть два  не кратных множителя $n=pq$ или один кратный $n=p^{\alpha}$. При $n>9$  последний случай очевидно подходит. Теперь $n=pq$, $p>q\geq 3$. Вернёмся к изначальной оценке и посмотрим на $\Nod (m,p-1)=\Nod(m,r)$. Заметим, что $2^t \Nod (m,p-1)= \Nod(n-1,p-1)$. Оценим последний $\Nod$. Заметим, что $n-1=pq-1\equiv q-1 (\mod p-1)$.
Тогда $\Nod(n-1,p-1)\leq q-1 < p-1$ и, так как является делителем $p-1$, то меньше, чем $\frac{p-1}{2}$. 
Итого $$\Nod (m,p-1)\leq \frac{1}{2}\Nod (n-1,p-1)\leq\frac{1}{4}(p-1),$$
что и даёт нужное неравенство.
\endproof


\section{Нормальные подгруппы и факторгруппа}

Однако далеко не всегда группа раскладывается в прямое произведение. Так, например, $\mb Z/p^2$, где $p$ простое не раскладывается нетривиальным образом в произведение двух подгрупп. Действительно, в ней всего одна нетривиальная подгруппа $\lan p \ran$. Найти непересекающуюся с ней нетривиальную подгруппу не представляется возможным. 

Однако мы довольно хорошо умеем упрощать работу по модулю $p^2$ переходя к сравнениям по модулю $p$. С точки зрения теории групп это означает, что мы берём образ всех элементов относительно сюръективного гомоморфизма 
$$\mb Z/p^2 \to \mb Z/p.$$
Возможность проконтролировать ситуацию так же гарантируется тем, что мы знаем, что любые два прообраза у элемента $\mb Z/p$ отличаются на элемент ядра.
Рассмотрим подробнее такую ситуацию. Пусть дан сюръективный гомоморфизм $f \colon G \to H$. Какую информацию про группу $G$ мы можем получить зная информацию про $H$ и $\Ker f$?

\utv Пусть дан сюръективный гомоморфизм $f \colon G \to H$. Пусть так же $g_1,\dots,g_k$ образующие $\Ker f$, а $h_1,\dots, h_l$ образующие $H$. Если взять $h_i'\in G$, такие, что $f(h_i')=h_i$, то группа $G$ будет порождена $h_1',\dots,h_l', g_1,\dots,g_k$.
\eutv
\proof  Воспользуемся простенькой леммой
\lm Пусть $f\colon G \to H$ -- гомоморфизм групп. Тогда $f(g_1)=f(g_2)$ тогда и только тогда, когда $g_1\in g_2 \Ker f$.
\elm
Пусть $g\in G$. Тогда $f(g)=h_{i_1}^{\eps_1}\dots h_{i_s}^{\eps_s}$. Тогда $g'={h_{i_1}'}^{\eps_1}\dots {h'_{i_s}}^{\eps_s}$ обладает свойством $f(g')=f(g)$. Тогда по лемме $g\in g'\Ker f$, то есть выражается через нужные образующие.
\endproof

\utv  Если $G$ конечна  и  $f\colon G \to H$ сюръективный гомоморфизм групп, то $|G|=|\Ker f| |H|$.
\eutv
\proof Каждый элемент $H$ соответствует ровно одному смежному классу $G/\Ker f$ по лемме.
\endproof

Здесь в рассмотрение попала подгруппа $\Ker f$ в $G$. Именно она в паре с $H$ позволила восстановить некоторую информацию про $G$. Таким образом, если мы ищем гомоморфизм $G$ в некоторую группу $H$, то сначала логично найти кандидата на ядро этого гомоморфизма, то есть подгруппу в $G$. Любая ли подгруппа может быть ядром гомоморфизма? 

Нет. Действительно, если $f \colon G \to G_1$, и есть $g \in G$ и $x\in \Ker f$, то  сопряжённый $gxg^{-1}$ тоже лежит в $\Ker f$. 
$$f(gxg^{-1})=f(g)f(x)f(g)^{-1}=f(g)f(g)^{-1}=1.$$
Это приводит нас к следующему определению.

\dfn[Нормальная подгруппа] Подгруппа $H\leq G$ называется нормальной, если для любого $g\in G$ и любого $h \in H$ выполнено, что $ghg^{-1}\in H$. То, что $H$ является нормальной подгруппой будем обозначать как $H \nrml G$
\edfn

\exm \enm
\item Пусть $G$ -- абелева группа. Тогда любая подгруппа в $G$ нормальна.
\item Пусть $f\colon G \to H$ -- гомомморфизм групп. Тогда $\Ker f$ -- нормальная подгруппа в $G$.
\item Подгруппа $V_4=\{\id, (12)(34), (13)(24), (14)(23)\}$ нормальна в $S_4$.
\item Подгруппа, порождённая поворотом на $\pi$ нормальна в $D_n$.
\item Если $G=G_1\times G_2$, то $G_1,G_2\nrml G$.
\eenm


\bibliographystyle{alpha}
\bibliography{lectures}

\end{document}
